---
const currentPath = Astro.url.pathname;

const navItems: { href: string; match: string; label: string; icon: string }[] = [
  { href: '/dashboard', match: '/dashboard', label: 'Inicio', icon: 'home' },
  { href: '/salud/vacunas', match: '/salud', label: 'Salud', icon: 'heart-pulse' },
  { href: '/alimentacion', match: '/alimentacion', label: 'Comida', icon: 'utensils' },
  { href: '/viajes', match: '/viajes', label: 'Vuelos', icon: 'plane' },
  { href: '/aventuras', match: '/aventuras', label: 'Fotos', icon: 'camera' },
];

function isActive(match: string): boolean {
  if (match === '/dashboard') return currentPath === '/dashboard';
  return currentPath.startsWith(match);
}
---

<!-- Bottom navigation bar for mobile -->
<nav class="no-print fixed bottom-0 left-0 right-0 z-40 border-t border-cream-dark/60 bg-white/95 backdrop-blur-xl safe-area-bottom sm:hidden">
  <div class="flex items-center justify-around px-1 py-1.5">
    {navItems.map((item) => {
      const active = isActive(item.match);
      return (
        <a
          href={item.href}
          class:list={[
            'relative flex flex-col items-center gap-0.5 rounded-2xl px-3 py-2 text-xs font-medium transition-all duration-200',
            active
              ? 'text-forest'
              : 'text-gray-400 hover:text-gray-600 active:scale-90',
          ]}
        >
          {active && (
            <span class="absolute inset-0 rounded-2xl bg-forest/8 transition-all duration-200" />
          )}
          <svg class:list={['relative h-6 w-6 transition-transform duration-200', active && 'scale-110']} data-icon={item.icon}>
            <use href={`#icon-${item.icon}`} />
          </svg>
          <span class:list={['relative', active && 'font-semibold']}>{item.label}</span>
          {active && (
            <span class="absolute -bottom-1.5 left-1/2 -translate-x-1/2 h-0.5 w-4 rounded-full bg-forest" />
          )}
        </a>
      );
    })}
  </div>
</nav>

<!-- Top navigation for desktop -->
<nav class="no-print hidden sm:block fixed top-0 left-0 right-0 z-40 border-b border-cream-dark/60 bg-white/95 backdrop-blur-xl">
  <div class="mx-auto flex max-w-5xl items-center justify-between px-6 py-3">
    <a href="/dashboard" class="flex items-center gap-2 text-xl font-extrabold text-forest tracking-tight">
      üêæ PetLog
    </a>
    <div class="flex items-center gap-1">
      {navItems.map((item) => {
        const active = isActive(item.match);
        return (
          <a
            href={item.href}
            class:list={[
              'relative rounded-xl px-4 py-2 text-sm font-medium transition-all duration-200',
              active
                ? 'bg-forest text-white shadow-sm'
                : 'text-gray-500 hover:bg-cream-dark hover:text-gray-800',
            ]}
          >
            {item.label}
          </a>
        );
      })}
      <a
        href="/perfil"
        class:list={[
          'ml-2 relative rounded-xl px-4 py-2 text-sm font-medium transition-all duration-200',
          isActive('/perfil')
            ? 'bg-forest text-white shadow-sm'
            : 'text-gray-500 hover:bg-cream-dark hover:text-gray-800',
        ]}
      >
        Perfil
      </a>
    </div>
  </div>
</nav>

<!-- SVG icon sprites -->
<svg class="hidden" xmlns="http://www.w3.org/2000/svg">
  <symbol id="icon-home" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
    <path d="m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z" />
    <polyline points="9 22 9 12 15 12 15 22" />
  </symbol>
  <symbol id="icon-heart-pulse" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
    <path d="M19.5 12.572l-7.5 7.428l-7.5 -7.428a5 5 0 1 1 7.5 -6.566a5 5 0 1 1 7.5 6.572" />
    <path d="M3 12h4l2 -3l4 6l2 -3h4" />
  </symbol>
  <symbol id="icon-utensils" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
    <path d="M3 2v7c0 1.1.9 2 2 2h4a2 2 0 0 0 2-2V2" /><path d="M7 2v20" /><path d="M21 15V2v0a5 5 0 0 0-5 5v6c0 1.1.9 2 2 2h3Zm0 0v7" />
  </symbol>
  <symbol id="icon-plane" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
    <path d="M17.8 19.2 16 11l3.5-3.5C21 6 21.5 4 21 3c-1-.5-3 0-4.5 1.5L13 8 4.8 6.2c-.5-.1-.9.1-1.1.5l-.3.5c-.2.5-.1 1 .3 1.3L9 12l-2 3H4l-1 1 3 2 2 3 1-1v-3l3-2 3.5 5.3c.3.4.8.5 1.3.3l.5-.2c.4-.3.6-.7.5-1.2z" />
  </symbol>
  <symbol id="icon-camera" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
    <path d="M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z" /><circle cx="12" cy="13" r="3" />
  </symbol>
</svg>

<style>
  .safe-area-bottom {
    padding-bottom: env(safe-area-inset-bottom, 0px);
  }
</style>
